@page
@using hippolidays.Models
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@model CalendarModel

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

@{
    ViewData["Title"] = "Home page";
}


@if (SignInManager.IsSignedIn(User))
{
    <div class="row">
        <div class="col-md-6">
            @await Component.InvokeAsync("Calendar")
        </div>
        <div class="col-md-3" align="right">
            <section>
                <div id="piechart" style="width: 900px; height: 500px;"></div>
            </section>
        </div>
        <div class="col-md-3" align="left">
            <section>
                <p class="approved row-md-1">Approved</p>
                <p class="pending row-md-1">Pending</p>
                <p class="updated row-md-1">Updated</p>
            </section>
        </div>
    </div>
}
else
{
    Response.Redirect("/Identity/Account/Login");

}

<script type="text/javascript">google.charts.load('current', { 'packages': ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {

        //mock data grab Users holiday instead of hardcoded data
        var data = google.visualization.arrayToDataTable([
            ['Option', 'Day'],
            ['Taken', @Model.approved],
            ['Pending', @Model.pending],
            ['Available', @Model.available]
        ]);

        var options = {
            title: 'My Holiday',
            pieSliceText: 'label',
            slices: {
                0: { color: '#01A851' },
                1: { color: '#E48A01' },
                2: { color: '#1163B3' }
            }
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart'));

        chart.draw(data, options);
    }</script>
